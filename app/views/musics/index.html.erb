<div class="container">

    <p id="notice"><%= notice %></p>

    <h1>Musics</h1>
  <div class="row">
    <div class="col-md-8">

          <table>
      <thead>
        <tr>
          <th></th>
          <th>投稿者</th>
          <th>Title</th>
          <th>Audio</th>
          <th></th>
          <th></th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @musics.each do |music| %>
          <tr>
            <td><%= attachment_image_tag(music.user, :profile_image, :fill, 50, 50, fallback: "no_image.jpg") %></td>
            <td><%= link_to music.user.name, user_path(music.user) %></td>
            <td><%= link_to music.title, music %></td>
            <td><%= audio_tag music.audio %></td>

                    <!-- いいね機能 -->
                <% if user_signed_in? %>
                  
                    <td><%= render 'musics/like', music: music%></td>
                  
                <% end %>


            <td>コメント数：<%= music.music_comments.count %></td>
            </tr>
            <tr>
            <td><%= link_to '楽曲詳細', music %></td>
            <% if music.user == current_user %>
            <td><%= link_to '編集', edit_music_path(music) %></td>
            <td><%= link_to '削除', music, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  </div>
    <br>

    <%= link_to '新規音楽投稿', new_music_path %>

    <div class="col-md-4">
    </div>

</div>


<script>
  audiojs.events.ready(function() {
    var as = audiojs.createAll();
  });
</script>